{% load static %}

<!DOCTYPE html>
<html lang="en">

{% load static %}
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ask Question - StackIt</title>
    <link rel="stylesheet" href="{% static 'css/main.css' %}" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet" />
</head>

<body class="bg-background min-h-screen">
        <header class="bg-surface border-b border-border sticky top-0 z-50 backdrop-blur-sm bg-white/95">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo -->
                <div class="flex items-center">
                    <a href="{% url 'dashboard_home' %}" class="flex items-center space-x-2">
                        <div class="w-8 h-8 bg-gradient-to-br from-primary-500 to-secondary-500 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                        <span class="text-xl font-bold text-text-primary">StackIt</span>
                    </a>
                </div>

                <!-- Search Bar -->
                <div class="hidden md:flex flex-1 max-w-2xl mx-8">
                    <div class="relative w-full">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <svg class="h-5 w-5 text-text-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                            </svg>
                        </div>
                        <input type="text" id="globalSearch" class="block w-full pl-10 pr-3 py-2 border border-border rounded-2xl leading-5 bg-surface placeholder-text-secondary focus:outline-none focus:placeholder-gray-400 focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200" placeholder="Search questions, tags, or users..." autocomplete="off" />
                        <!-- Search Suggestions Dropdown -->
                        <div id="searchSuggestions" class="absolute top-full left-0 right-0 bg-surface border border-border rounded-2xl shadow-lg mt-1 hidden z-50">
                            <div class="p-2">
                                <div class="text-xs text-text-secondary px-3 py-2 font-medium">Recent Searches</div>
                                <a href="{% url 'question_detail' %}
" class="block px-3 py-2 text-sm text-text-primary hover:bg-gray-50 rounded-lg transition-colors duration-200">
                                    How to implement JWT authentication in Node.js?
                                </a>
                                <a href="{% url 'question_detail' %}
" class="block px-3 py-2 text-sm text-text-primary hover:bg-gray-50 rounded-lg transition-colors duration-200">
                                    React hooks vs class components
                                </a>
                                <a href="{% url 'question_detail' %}
" class="block px-3 py-2 text-sm text-text-primary hover:bg-gray-50 rounded-lg transition-colors duration-200">
                                    Docker container optimization
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Navigation & User Menu -->
                <div class="flex items-center space-x-4">
                    <!-- Navigation Links -->
                    <nav class="hidden lg:flex items-center space-x-6">
                        <a href="{% url 'dashboard_home' %}" class="text-primary-600 font-medium hover:text-primary-700 transition-colors duration-200">Home</a>
                        <a href="{% url 'browse_questions' %}" class="text-text-secondary hover:text-text-primary transition-colors duration-200">Questions</a>
                    </nav>

                    <!-- Ask Question Button -->
                    <a href="{% url 'ask_question' %}" class="hidden sm:inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-2xl text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-all duration-200 hover:shadow-lg hover:shadow-primary-500/25">
                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                        </svg>
                        Ask Question
                    </a>

                    <!-- User Menu -->
                    <div class="relative">
                        <button id="userMenuButton" class="flex items-center space-x-2 p-2 rounded-2xl hover:bg-gray-50 transition-colors duration-200">
                            <img class="w-8 h-8 rounded-full object-cover" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="User avatar" onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;" />
                            <span class="hidden sm:block text-sm font-medium text-text-primary">Demo User</span>
                            <svg class="w-4 h-4 text-text-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                            </svg>
                        </button>

                        <!-- User Dropdown -->
                        <div id="userDropdown" class="absolute right-0 mt-2 w-48 bg-surface rounded-2xl shadow-lg border border-border hidden z-50">
                            <div class="py-1">
                                <a href="{% url 'user_profile' %}
" class="flex items-center px-4 py-2 text-sm text-text-primary hover:bg-gray-50 transition-colors duration-200">
                                    <svg class="w-4 h-4 mr-3 text-text-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                                    </svg>
                                    Profile
                                </a>
                               
                                <div class="border-t border-border my-1"></div>
                                <a href="{% url 'login' %}" class="flex items-center px-4 py-2 text-sm text-error-600 hover:bg-error-50 transition-colors duration-200">
                                    <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
                                    </svg>
                                    Sign Out
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- Mobile Menu Button -->
                    <button id="mobileMenuButton" class="lg:hidden p-2 rounded-lg text-text-secondary hover:text-text-primary hover:bg-gray-50 transition-colors duration-200">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Mobile Menu -->
            <div id="mobileMenu" class="lg:hidden hidden border-t border-border">
                <div class="px-2 pt-2 pb-3 space-y-1">
                    <!-- Mobile Search -->
                    <div class="px-3 py-2">
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <svg class="h-5 w-5 text-text-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                                </svg>
                            </div>
                            <input type="text" class="block w-full pl-10 pr-3 py-2 border border-border rounded-2xl leading-5 bg-surface placeholder-text-secondary focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent" placeholder="Search..." />
                        </div>
                    </div>
                    
                    <!-- Mobile Navigation Links -->
                    <a href="{% url 'dashboard_home' %}" class="block px-3 py-2 text-base font-medium text-primary-600 bg-primary-50 rounded-lg">Home</a>
                    <a href="{% url 'browse_questions' %}" class="block px-3 py-2 text-base font-medium text-text-secondary hover:text-text-primary hover:bg-gray-50 rounded-lg transition-colors duration-200">Questions</a>
                    <a href="{% url 'ask_question' %}" class="block px-3 py-2 text-base font-medium text-text-secondary hover:text-text-primary hover:bg-gray-50 rounded-lg transition-colors duration-200">Ask Question</a>
                </div>
            </div>
        </div>
    </header>
    <!-- Breadcrumb -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
        <nav class="flex items-center space-x-2 text-sm">
            <a href="{% url 'dashboard_home' %}"
                class="text-text-secondary hover:text-primary-600 transition-colors duration-200">Home</a>
            <svg class="w-4 h-4 text-text-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
            <span class="text-text-primary font-medium">Ask Question</span>
        </nav>
    </div>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-12">
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
            <!-- Main Form Area -->
            <div class="lg:col-span-3">
                <!-- Page Header -->
                <div class="mb-8">
                    <h1 class="text-3xl font-bold text-text-primary mb-2">Ask a Question</h1>
                    <p class="text-text-secondary">Get help from our community of developers. Be specific and provide
                        context for better answers.</p>
                </div>

                <!-- Question Form -->
                <form id="questionForm" class="space-y-6" onsubmit="handleQuestionSubmit(event)">
                    <!-- Title Field -->
                    <div class="bg-surface rounded-2xl border border-border p-6">
                        <label for="questionTitle" class="block text-sm font-semibold text-text-primary mb-3">
                            Question Title *
                            <span class="text-text-secondary font-normal ml-2">Be specific and imagine you're asking a
                                question to another person</span>
                        </label>
                        <input type="text" id="questionTitle" name="title"
                            class="w-full px-4 py-3 border border-border rounded-2xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200"
                            placeholder="e.g., How to implement authentication in React with JWT tokens?" required
                            maxlength="150"
                            oninput="updateCharacterCount('questionTitle', 'titleCounter', 150); checkForDuplicates()" />
                        <div class="flex justify-between items-center mt-2">
                            <div id="titleError" class="text-error-500 text-sm hidden"></div>
                            <span id="titleCounter" class="text-text-secondary text-sm">0/150</span>
                        </div>
                    </div>

                    <!-- AI Question Improvement Panel -->
                    <div id="aiImprovementPanel" class="bg-primary-50 border border-primary-200 rounded-2xl p-6 hidden">
                        <div class="flex items-start space-x-3">
                            <div
                                class="w-8 h-8 bg-primary-500 rounded-lg flex items-center justify-center flex-shrink-0">
                                <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                                </svg>
                            </div>
                            <div class="flex-1">
                                <h3 class="text-sm font-semibold text-primary-700 mb-2">AI Suggestion</h3>
                                <div id="aiSuggestion" class="text-sm text-primary-600 mb-3"></div>
                                <button type="button" onclick="applyAISuggestion()"
                                    class="text-sm bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors duration-200">
                                    Apply Suggestion
                                </button>
                            </div>
                            <button type="button" onclick="hideAIPanel()"
                                class="text-primary-400 hover:text-primary-600 transition-colors duration-200">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M6 18L18 6M6 6l12 12" />
                                </svg>
                            </button>
                        </div>
                    </div>

                    <!-- Description Field -->
                    <div class="bg-surface rounded-2xl border border-border p-6">
                        <div class="flex items-center justify-between mb-3">
                            <label for="questionDescription" class="block text-sm font-semibold text-text-primary">
                                Description *
                                <span class="text-text-secondary font-normal ml-2">Provide details, code snippets, and
                                    context</span>
                            </label>
                            <div class="flex items-center space-x-2">
                                <button type="button" onclick="togglePreviewMode()"
                                    class="text-sm text-primary-600 hover:text-primary-700 transition-colors duration-200">
                                    <span id="previewToggleText">Preview</span>
                                </button>
                                <span class="text-text-secondary">|</span>
                                <button type="button" onclick="showMarkdownHelp()"
                                    class="text-sm text-text-secondary hover:text-text-primary transition-colors duration-200">
                                    Markdown Help
                                </button>
                            </div>
                        </div>

                        <!-- Editor Toolbar -->
                        <div class="flex items-center space-x-2 mb-3 p-2 bg-gray-50 rounded-lg">
                            <button type="button" onclick="insertMarkdown('**', '**')"
                                class="p-2 text-text-secondary hover:text-text-primary rounded transition-colors duration-200"
                                title="Bold">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path
                                        d="M3 4a1 1 0 011-1h5.5a2.5 2.5 0 010 5H6v2h4.5a2.5 2.5 0 010 5H4a1 1 0 01-1-1V4z" />
                                </svg>
                            </button>
                            <button type="button" onclick="insertMarkdown('*', '*')"
                                class="p-2 text-text-secondary hover:text-text-primary rounded transition-colors duration-200"
                                title="Italic">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path
                                        d="M8 1a1 1 0 000 2h1.5L7 15H5a1 1 0 100 2h6a1 1 0 100-2h-1.5L12 3h2a1 1 0 100-2H8z" />
                                </svg>
                            </button>
                            <button type="button" onclick="insertMarkdown('`', '`')"
                                class="p-2 text-text-secondary hover:text-text-primary rounded transition-colors duration-200"
                                title="Code">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd"
                                        d="M12.316 3.051a1 1 0 01.633 1.265l-4 12a1 1 0 11-1.898-.632l4-12a1 1 0 011.265-.633zM5.707 6.293a1 1 0 010 1.414L3.414 10l2.293 2.293a1 1 0 11-1.414 1.414l-3-3a1 1 0 010-1.414l3-3a1 1 0 011.414 0zm8.586 0a1 1 0 011.414 0l3 3a1 1 0 010 1.414l-3 3a1 1 0 11-1.414-1.414L16.586 10l-2.293-2.293a1 1 0 010-1.414z" />
                                </svg>
                            </button>
                            <button type="button" onclick="insertMarkdown('```\n', '\n```')"
                                class="p-2 text-text-secondary hover:text-text-primary rounded transition-colors duration-200"
                                title="Code Block">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                </svg>
                            </button>
                            <button type="button" onclick="insertMarkdown('[', '](url)')"
                                class="p-2 text-text-secondary hover:text-text-primary rounded transition-colors duration-200"
                                title="Link">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" />
                                </svg>
                            </button>
                        </div>

                        <!-- Text Area -->
                        <div id="editorContainer">
                            <textarea id="questionDescription" name="description" rows="12"
                                class="w-full px-4 py-3 border border-border rounded-2xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 font-mono text-sm"
                                placeholder="Describe your problem in detail. Include:
- What you're trying to achieve
- What you've tried so far
- Any error messages
- Relevant code snippets
- Your environment (OS, browser, versions, etc.)" required oninput="generateAutoTags(); saveDraft()"></textarea>
                        </div>

                        <!-- Preview Container -->
                        <div id="previewContainer"
                            class="hidden w-full px-4 py-3 border border-border rounded-2xl bg-gray-50 min-h-[300px]">
                            <div id="previewContent" class="prose prose-sm max-w-none"></div>
                        </div>

                        <div id="descriptionError" class="text-error-500 text-sm mt-2 hidden"></div>
                    </div>

                    <!-- Tags Field -->
                    <div class="bg-surface rounded-2xl border border-border p-6">
                        <label class="block text-sm font-semibold text-text-primary mb-3">
                            Tags
                            <span class="text-text-secondary font-normal ml-2">Add up to 5 tags to describe what your
                                question is about</span>
                        </label>

                        <!-- AI Suggested Tags -->
                        <div id="aiTagSuggestions" class="mb-4 hidden">
                            <div class="flex items-center space-x-2 mb-2">
                                <svg class="w-4 h-4 text-primary-500" fill="none" stroke="currentColor"
                                    viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                                </svg>
                                <span class="text-sm font-medium text-primary-600">AI Suggested Tags:</span>
                            </div>
                            <div id="suggestedTagsList" class="flex flex-wrap gap-2"></div>
                        </div>

                        <!-- Selected Tags -->
                        <div id="selectedTags" class="flex flex-wrap gap-2 mb-3"></div>

                        <!-- Tag Input -->
                        <div class="relative">
                            <input type="text" id="tagInput" placeholder="Type to search or add tags..."
                                class="w-full px-4 py-3 border border-border rounded-2xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200"
                                oninput="searchTags(this.value)" onkeydown="handleTagInput(event)" />

                            <!-- Tag Suggestions Dropdown -->
                            <div id="tagSuggestions"
                                class="hidden absolute top-full left-0 right-0 mt-1 bg-surface border border-border rounded-2xl shadow-lg max-h-48 overflow-y-auto z-10">
                            </div>
                        </div>

                        <div class="text-xs text-text-secondary mt-2">
                            Press Enter or click to add tags. Popular tags: javascript, python, react, node.js, css
                        </div>
                    </div>

                    <!-- Tone Adjustment -->
                    <div class="bg-surface rounded-2xl border border-border p-6">
                        <label class="block text-sm font-semibold text-text-primary mb-3">
                            Question Tone
                            <span class="text-text-secondary font-normal ml-2">Adjust the complexity level of your
                                question</span>
                        </label>

                        <div class="flex items-center space-x-4">
                            <label class="flex items-center">
                                <input type="radio" name="tone" value="beginner"
                                    class="w-4 h-4 text-primary-600 border-border focus:ring-primary-500" checked />
                                <span class="ml-2 text-sm text-text-primary">Beginner-friendly</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="tone" value="intermediate"
                                    class="w-4 h-4 text-primary-600 border-border focus:ring-primary-500" />
                                <span class="ml-2 text-sm text-text-primary">Intermediate</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="tone" value="expert"
                                    class="w-4 h-4 text-primary-600 border-border focus:ring-primary-500" />
                                <span class="ml-2 text-sm text-text-primary">Expert level</span>
                            </label>
                        </div>
                    </div>

                    <!-- Form Actions -->
                    <div class="flex flex-col sm:flex-row gap-4">
                        <button type="submit"
                            class="flex-1 bg-primary-600 text-white py-3 px-6 rounded-2xl font-medium hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-all duration-200 hover:shadow-lg hover:shadow-primary-500/25">
                            <span id="submitButtonText">Post Question</span>
                            <div id="submitSpinner" class="hidden inline-flex items-center">
                                <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white"
                                    xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor"
                                        stroke-width="4" />
                                    <path class="opacity-75" fill="currentColor"
                                        d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" />
                                </svg>
                                Posting...
                            </div>
                        </button>

                        <button type="button" onclick="saveDraft()"
                            class="sm:w-auto bg-surface text-text-primary py-3 px-6 rounded-2xl font-medium border border-border hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 transition-all duration-200">
                            Save Draft
                        </button>
                    </div>
                </form>
            </div>

            <!-- Sidebar -->
            <div class="lg:col-span-1 space-y-6">
                <!-- Similar Questions -->
                <div id="similarQuestions" class="bg-surface rounded-2xl border border-border p-6 hidden">
                    <h3 class="text-lg font-semibold text-text-primary mb-4">Similar Questions</h3>
                    <div id="similarQuestionsList" class="space-y-3"></div>
                </div>

                <!-- Writing Tips -->
                <div class="bg-surface rounded-2xl border border-border p-6">
                    <h3 class="text-lg font-semibold text-text-primary mb-4">Writing a Good Question</h3>
                    <div class="space-y-3">
                        <div class="flex items-start space-x-3">
                            <div
                                class="w-6 h-6 bg-success-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                                <svg class="w-3 h-3 text-success-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd"
                                        d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" />
                                </svg>
                            </div>
                            <div>
                                <h4 class="text-sm font-medium text-text-primary">Be specific</h4>
                                <p class="text-xs text-text-secondary">Include exact error messages and describe what
                                    you expected to happen.</p>
                            </div>
                        </div>

                        <div class="flex items-start space-x-3">
                            <div
                                class="w-6 h-6 bg-success-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                                <svg class="w-3 h-3 text-success-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd"
                                        d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" />
                                </svg>
                            </div>
                            <div>
                                <h4 class="text-sm font-medium text-text-primary">Show your work</h4>
                                <p class="text-xs text-text-secondary">Include code you've tried and explain what
                                    happened when you ran it.</p>
                            </div>
                        </div>

                        <div class="flex items-start space-x-3">
                            <div
                                class="w-6 h-6 bg-success-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                                <svg class="w-3 h-3 text-success-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd"
                                        d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" />
                                </svg>
                            </div>
                            <div>
                                <h4 class="text-sm font-medium text-text-primary">Use proper formatting</h4>
                                <p class="text-xs text-text-secondary">Format code blocks and use markdown for better
                                    readability.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Community Guidelines -->
                <div class="bg-surface rounded-2xl border border-border p-6">
                    <h3 class="text-lg font-semibold text-text-primary mb-4">Community Guidelines</h3>
                    <div class="space-y-2">
                        <p class="text-sm text-text-secondary">• Be respectful and constructive</p>
                        <p class="text-sm text-text-secondary">• Search before asking</p>
                        <p class="text-sm text-text-secondary">• One question per post</p>
                        <p class="text-sm text-text-secondary">• Accept helpful answers</p>
                    </div>
                    <a href="javascript:void(0)"
                        class="text-sm text-primary-600 hover:text-primary-700 transition-colors duration-200 mt-3 inline-block">
                        Read full guidelines →
                    </a>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-surface border-t border-border mt-auto">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <!-- Company Info -->
                <div class="col-span-1 md:col-span-2">
                    <div class="flex items-center space-x-2 mb-4">
                        <div
                            class="w-8 h-8 bg-gradient-to-br from-primary-500 to-secondary-500 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                        </div>
                        <span class="text-xl font-bold text-text-primary">StackIt</span>
                    </div>
                    <p class="text-text-secondary text-sm mb-4">
                        AI-powered Q&A platform for developers. Get instant answers, share knowledge, and build your
                        reputation in the tech community.
                    </p>
                    <div class="flex space-x-4">
                        <a href="javascript:void(0)"
                            class="text-text-secondary hover:text-primary-600 transition-colors duration-200">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M10 0C4.477 0 0 4.484 0 10.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0110 4.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.203 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.942.359.31.678.921.678 1.856 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0020 10.017C20 4.484 15.522 0 10 0z"
                                    clip-rule="evenodd" />
                            </svg>
                        </a>
                        <a href="javascript:void(0)"
                            class="text-text-secondary hover:text-primary-600 transition-colors duration-200">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                <path
                                    d="M6.29 18.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0020 3.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.073 4.073 0 01.8 7.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 010 16.407a11.616 11.616 0 006.29 1.84" />
                            </svg>
                        </a>
                    </div>
                </div>

                <!-- Quick Links -->
                <div>
                    <h3 class="text-sm font-semibold text-text-primary mb-4">Platform</h3>
                    <ul class="space-y-2">
                        <li><a href="browse_questions.html"
                                class="text-sm text-text-secondary hover:text-primary-600 transition-colors duration-200">Browse
                                Questions</a></li>
                        <li><a href="{% url 'ask_question' %}"
                                class="text-sm text-text-secondary hover:text-primary-600 transition-colors duration-200">Ask
                                Question</a></li>
                        <li><a href="javascript:void(0)"
                                class="text-sm text-text-secondary hover:text-primary-600 transition-colors duration-200">Tags</a>
                        </li>
                        <li><a href="javascript:void(0)"
                                class="text-sm text-text-secondary hover:text-primary-600 transition-colors duration-200">Users</a>
                        </li>
                    </ul>
                </div>

                <!-- Support -->
                <div>
                    <h3 class="text-sm font-semibold text-text-primary mb-4">Support</h3>
                    <ul class="space-y-2">
                        <li><a href="javascript:void(0)"
                                class="text-sm text-text-secondary hover:text-primary-600 transition-colors duration-200">Help
                                Center</a></li>
                        <li><a href="javascript:void(0)"
                                class="text-sm text-text-secondary hover:text-primary-600 transition-colors duration-200">Contact
                                Us</a></li>
                        <li><a href="javascript:void(0)"
                                class="text-sm text-text-secondary hover:text-primary-600 transition-colors duration-200">Privacy
                                Policy</a></li>
                        <li><a href="javascript:void(0)"
                                class="text-sm text-text-secondary hover:text-primary-600 transition-colors duration-200">Terms
                                of Service</a></li>
                    </ul>
                </div>
            </div>

            <div class="border-t border-border mt-8 pt-8 text-center">
                <p class="text-sm text-text-secondary">
                    © 2025 StackIt. All rights reserved.
                </p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // Global variables
        let selectedTags = [];
        let isPreviewMode = false;
        let aiSuggestionText = '';

        // Popular tags for suggestions
        const popularTags = [
            'javascript', 'python', 'react', 'node.js', 'css', 'html', 'java', 'typescript',
            'angular', 'vue.js', 'php', 'c#', 'c++', 'sql', 'mongodb', 'express',
            'django', 'flask', 'spring', 'laravel', 'bootstrap', 'tailwind', 'git',
            'docker', 'kubernetes', 'aws', 'firebase', 'graphql', 'rest-api'
        ];

        // Mock similar questions data
        const mockSimilarQuestions = [
            {
                title: "How to handle authentication in React applications?",
                similarity: 85,
                url: "{% url 'question_detail' %}"
            },
            {
                title: "JWT token implementation best practices",
                similarity: 78,
                url: "{% url 'question_detail' %}"
            },
            {
                title: "React Router authentication guards",
                similarity: 72,
                url: "{% url 'question_detail' %}"
            }
        ];

        // Initialize page
        document.addEventListener('DOMContentLoaded', function () {
            loadDraft();
            setupEventListeners();
        });

        // Setup event listeners
        function setupEventListeners() {
            // Close dropdowns when clicking outside
            document.addEventListener('click', function (event) {
                if (!event.target.closest('#tagInput') && !event.target.closest('#tagSuggestions')) {
                    hideTagSuggestions();
                }
                if (!event.target.closest('#userMenu') && !event.target.closest('button[onclick="toggleUserMenu()"]')) {
                    hideUserMenu();
                }
            });
        }

        // Toggle mobile menu
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenu');
            mobileMenu.classList.toggle('hidden');
        }

        // Toggle user menu
        function toggleUserMenu() {
            const userMenu = document.getElementById('userMenu');
            userMenu.classList.toggle('hidden');
        }

        function hideUserMenu() {
            const userMenu = document.getElementById('userMenu');
            userMenu.classList.add('hidden');
        }

        // Character counter
        function updateCharacterCount(inputId, counterId, maxLength) {
            const input = document.getElementById(inputId);
            const counter = document.getElementById(counterId);
            const currentLength = input.value.length;

            counter.textContent = `${currentLength}/${maxLength}`;

            if (currentLength > maxLength * 0.9) {
                counter.classList.add('text-warning-500');
            } else {
                counter.classList.remove('text-warning-500');
            }
        }

        // Check for duplicate questions
        function checkForDuplicates() {
            const title = document.getElementById('questionTitle').value;

            if (title.length > 20) {
                // Simulate AI duplicate detection
                setTimeout(() => {
                    showSimilarQuestions();
                }, 500);
            } else {
                hideSimilarQuestions();
            }
        }

        // Show similar questions
        function showSimilarQuestions() {
            const container = document.getElementById('similarQuestions');
            const list = document.getElementById('similarQuestionsList');

            list.innerHTML = mockSimilarQuestions.map(q => `
                <div class="border border-border rounded-lg p-3 hover:bg-gray-50 transition-colors duration-200">
                    <a href="${q.url}" class="block">
                        <h4 class="text-sm font-medium text-text-primary mb-1">${q.title}</h4>
                        <div class="flex items-center space-x-2">
                            <span class="text-xs text-text-secondary">Similarity:</span>
                            <div class="flex-1 bg-gray-200 rounded-full h-1.5">
                                <div class="bg-primary-500 h-1.5 rounded-full" style="width: ${q.similarity}%"></div>
                            </div>
                            <span class="text-xs text-primary-600 font-medium">${q.similarity}%</span>
                        </div>
                    </a>
                </div>
            `).join('');

            container.classList.remove('hidden');
        }

        // Hide similar questions
        function hideSimilarQuestions() {
            const container = document.getElementById('similarQuestions');
            container.classList.add('hidden');
        }

        // Generate auto tags using AI
        function generateAutoTags() {
            const description = document.getElementById('questionDescription').value;
            const title = document.getElementById('questionTitle').value;

            if ((title + description).length > 50) {
                // Simulate AI tag generation
                setTimeout(() => {
                    const suggestedTags = ['javascript', 'react', 'authentication', 'jwt', 'security'];
                    showAISuggestedTags(suggestedTags);
                }, 1000);
            }
        }

        // Show AI suggested tags
        function showAISuggestedTags(tags) {
            const container = document.getElementById('aiTagSuggestions');
            const list = document.getElementById('suggestedTagsList');

            list.innerHTML = tags.map(tag => `
                <button 
                    type="button" 
                    onclick="addSuggestedTag('${tag}')"
                    class="px-3 py-1 bg-primary-100 text-primary-700 rounded-full text-sm hover:bg-primary-200 transition-colors duration-200"
                >
                    ${tag}
                </button>
            `).join('');

            container.classList.remove('hidden');
        }

        // Add suggested tag
        function addSuggestedTag(tag) {
            if (!selectedTags.includes(tag) && selectedTags.length < 5) {
                selectedTags.push(tag);
                updateSelectedTags();
            }
        }

        // Search tags
        function searchTags(query) {
            if (query.length < 2) {
                hideTagSuggestions();
                return;
            }

            const filteredTags = popularTags.filter(tag =>
                tag.toLowerCase().includes(query.toLowerCase()) &&
                !selectedTags.includes(tag)
            );

            showTagSuggestions(filteredTags);
        }

        // Show tag suggestions
        function showTagSuggestions(tags) {
            const container = document.getElementById('tagSuggestions');

            if (tags.length === 0) {
                hideTagSuggestions();
                return;
            }

            container.innerHTML = tags.slice(0, 8).map(tag => `
                <button 
                    type="button" 
                    onclick="addTag('${tag}')"
                    class="block w-full text-left px-4 py-2 text-sm text-text-primary hover:bg-gray-50 transition-colors duration-200"
                >
                    ${tag}
                </button>
            `).join('');

            container.classList.remove('hidden');
        }

        // Hide tag suggestions
        function hideTagSuggestions() {
            const container = document.getElementById('tagSuggestions');
            container.classList.add('hidden');
        }

        // Handle tag input
        function handleTagInput(event) {
            if (event.key === 'Enter') {
                event.preventDefault();
                const input = event.target;
                const tag = input.value.trim().toLowerCase();

                if (tag && !selectedTags.includes(tag) && selectedTags.length < 5) {
                    addTag(tag);
                }
            }
        }

        // Add tag
        function addTag(tag) {
            if (selectedTags.length >= 5) {
                alert('You can only add up to 5 tags');
                return;
            }

            selectedTags.push(tag);
            updateSelectedTags();

            const input = document.getElementById('tagInput');
            input.value = '';
            hideTagSuggestions();
        }

        // Remove tag
        function removeTag(tag) {
            selectedTags = selectedTags.filter(t => t !== tag);
            updateSelectedTags();
        }

        // Update selected tags display
        function updateSelectedTags() {
            const container = document.getElementById('selectedTags');

            container.innerHTML = selectedTags.map(tag => `
                <span class="inline-flex items-center px-3 py-1 bg-primary-100 text-primary-700 rounded-full text-sm">
                    ${tag}
                    <button 
                        type="button" 
                        onclick="removeTag('${tag}')"
                        class="ml-2 text-primary-500 hover:text-primary-700 transition-colors duration-200"
                    >
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </span>
            `).join('');
        }

        // Toggle preview mode
        function togglePreviewMode() {
            const editorContainer = document.getElementById('editorContainer');
            const previewContainer = document.getElementById('previewContainer');
            const toggleText = document.getElementById('previewToggleText');
            const description = document.getElementById('questionDescription').value;

            isPreviewMode = !isPreviewMode;

            if (isPreviewMode) {
                editorContainer.classList.add('hidden');
                previewContainer.classList.remove('hidden');
                toggleText.textContent = 'Edit';

                // Convert markdown to HTML (simplified)
                const previewContent = document.getElementById('previewContent');
                previewContent.innerHTML = convertMarkdownToHTML(description);
            } else {
                editorContainer.classList.remove('hidden');
                previewContainer.classList.add('hidden');
                toggleText.textContent = 'Preview';
            }
        }

        // Simple markdown to HTML converter
        function convertMarkdownToHTML(markdown) {
            return markdown
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                .replace(/`(.*?)`/g, '<code class="bg-gray-100 px-1 rounded">$1</code>')
                .replace(/```([\s\S]*?)```/g, '<pre class="bg-gray-100 p-3 rounded-lg overflow-x-auto"><code>$1</code></pre>')
                .replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2" class="text-primary-600 hover:text-primary-700">$1</a>')
                .replace(/\n/g, '<br>');
        }

        // Show markdown help
        function showMarkdownHelp() {
            alert(`Markdown Help:

**Bold text** - **bold**
*Italic text* - *italic*
\`Inline code\` - \`code\`
\`\`\`
Code block
\`\`\`
[Link text](URL) - [link](url)`);
        }

        // Insert markdown
        function insertMarkdown(before, after) {
            const textarea = document.getElementById('questionDescription');
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            const selectedText = textarea.value.substring(start, end);

            const newText = before + selectedText + after;
            textarea.value = textarea.value.substring(0, start) + newText + textarea.value.substring(end);

            // Set cursor position
            const newCursorPos = start + before.length + selectedText.length;
            textarea.setSelectionRange(newCursorPos, newCursorPos);
            textarea.focus();
        }

        // AI question improvement
        function improveQuestionWithAI() {
            const title = document.getElementById('questionTitle').value;

            if (title.length > 10) {
                // Simulate AI improvement suggestion
                setTimeout(() => {
                    aiSuggestionText = `How to implement secure user authentication in a React application using JWT tokens and handle token refresh?`;
                    showAIImprovement(aiSuggestionText);
                }, 1000);
            }
        }

        // Show AI improvement suggestion
        function showAIImprovement(suggestion) {
            const panel = document.getElementById('aiImprovementPanel');
            const suggestionElement = document.getElementById('aiSuggestion');

            suggestionElement.textContent = suggestion;
            panel.classList.remove('hidden');
        }

        // Apply AI suggestion
        function applyAISuggestion() {
            const titleInput = document.getElementById('questionTitle');
            titleInput.value = aiSuggestionText;
            updateCharacterCount('questionTitle', 'titleCounter', 150);
            hideAIPanel();
        }

        // Hide AI panel
        function hideAIPanel() {
            const panel = document.getElementById('aiImprovementPanel');
            panel.classList.add('hidden');
        }

        // Save draft
        function saveDraft() {
            const formData = {
                title: document.getElementById('questionTitle').value,
                description: document.getElementById('questionDescription').value,
                tags: selectedTags,
                tone: document.querySelector('input[name="tone"]:checked')?.value || 'beginner',
                timestamp: new Date().toISOString()
            };

            localStorage.setItem('questionDraft', JSON.stringify(formData));

            // Show brief feedback
            const button = event?.target;
            if (button) {
                const originalText = button.textContent;
                button.textContent = 'Saved!';
                button.classList.add('bg-success-600');

                setTimeout(() => {
                    button.textContent = originalText;
                    button.classList.remove('bg-success-600');
                }, 1000);
            }
        }

        // Load draft
        function loadDraft() {
            const draft = localStorage.getItem('questionDraft');

            if (draft) {
                try {
                    const formData = JSON.parse(draft);

                    document.getElementById('questionTitle').value = formData.title || '';
                    document.getElementById('questionDescription').value = formData.description || '';

                    if (formData.tags) {
                        selectedTags = formData.tags;
                        updateSelectedTags();
                    }

                    if (formData.tone) {
                        const toneRadio = document.querySelector(`input[name="tone"][value="${formData.tone}"]`);
                        if (toneRadio) toneRadio.checked = true;
                    }

                    // Update character count
                    updateCharacterCount('questionTitle', 'titleCounter', 150);
                } catch (e) {
                    console.error('Error loading draft:', e);
                }
            }
        }

        // Form validation
        function validateForm() {
            let isValid = true;

            // Clear previous errors
            document.getElementById('titleError').classList.add('hidden');
            document.getElementById('descriptionError').classList.add('hidden');

            // Validate title
            const title = document.getElementById('questionTitle').value.trim();
            if (!title) {
                showError('titleError', 'Question title is required');
                isValid = false;
            } else if (title.length < 10) {
                showError('titleError', 'Title must be at least 10 characters long');
                isValid = false;
            }

            // Validate description
            const description = document.getElementById('questionDescription').value.trim();
            if (!description) {
                showError('descriptionError', 'Question description is required');
                isValid = false;
            } else if (description.length < 30) {
                showError('descriptionError', 'Description must be at least 30 characters long');
                isValid = false;
            }

            return isValid;
        }

        // Show error
        function showError(elementId, message) {
            const errorElement = document.getElementById(elementId);
            errorElement.textContent = message;
            errorElement.classList.remove('hidden');
        }

        // Handle form submission
        function handleQuestionSubmit(event) {
            event.preventDefault();

            if (!validateForm()) {
                return;
            }

            // Show loading state
            const submitButton = document.getElementById('submitButtonText');
            const spinner = document.getElementById('submitSpinner');

            submitButton.classList.add('hidden');
            spinner.classList.remove('hidden');

            // Simulate form submission
            setTimeout(() => {
                // Clear draft
                localStorage.removeItem('questionDraft');

                // Redirect to question detail page
                window.location.href = '{% url "question_detail" %}';
            }, 2000);
        }

        // Trigger AI improvement on title change
        document.getElementById('questionTitle').addEventListener('input', function () {
            const title = this.value;
            if (title.length > 20) {
                setTimeout(() => {
                    improveQuestionWithAI();
                }, 1000);
            }
        });
    </script>
    <script id="dhws-dataInjector" src="../public/dhws-data-injector.js"></script>
</body>

</html>